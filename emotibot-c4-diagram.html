<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmotiBot - Microservices Architecture Diagram</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin: 0;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
            margin: 10px 0 0 0;
        }
        
        .diagram-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .feature-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #667eea;
        }
        
        .feature-card h3 {
            color: #2c3e50;
            margin: 0 0 15px 0;
            font-size: 1.3em;
        }
        
        .feature-card ul {
            margin: 0;
            padding-left: 20px;
            color: #495057;
        }
        
        .feature-card li {
            margin-bottom: 5px;
        }
        
        .tech-stack {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            text-align: center;
        }
        
        .tech-stack h3 {
            margin: 0 0 20px 0;
            font-size: 1.5em;
        }
        
        .tech-badges {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        
        .tech-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 25px;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            margin: 0 10px;
            transition: transform 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                margin: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .features {
                grid-template-columns: 1fr;
            }
        }
        
        @media print {
            body * { visibility: hidden; }
            .diagram-container, .diagram-container * { visibility: visible; }
            .diagram-container { position: absolute; left: 0; top: 0; width: 100%; }
            .controls { display: none !important; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ EmotiBot Architecture</h1>
            <p>Enterprise-Grade Microservices Architecture Showcase</p>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="downloadDiagram()">üì• Download PNG</button>
            <button class="btn" onclick="toggleFullscreen()">üîç Fullscreen</button>
            <button class="btn" onclick="printDiagram()">üñ®Ô∏è Print</button>
        </div>
        
        <div class="diagram-container" id="diagram-container">
            <div class="mermaid" id="mermaid-diagram">
C4Context
    title EmotiBot - Microservices Architecture Context Diagram
    
    Person(user, "User", "Interacts with EmotiBot for<br/>emotional AI conversations")
    
    System_Boundary(emotibot, "EmotiBot System") {
        Container(frontend, "Web Frontend", "Nginx, HTML/JS", "Interactive demo interface<br/>with real-time service monitoring")
        
        Container(auth, "Auth Service", "Flask, Python", "JWT authentication<br/>and user management")
        Container(emotion, "Emotion Service", "Flask, TextBlob", "Text emotion analysis<br/>and sentiment detection")
        Container(conversation, "Conversation Service", "Flask, Python", "Chat history management<br/>and conversation tracking")
        Container(ai, "AI Service", "Flask, Gemini API", "AI response generation<br/>with intelligent fallbacks")
        Container(websocket, "WebSocket Service", "Flask-SocketIO", "Real-time communication<br/>and live updates")
        
        ContainerDb(authdb, "Auth Database", "PostgreSQL", "User accounts<br/>and authentication data")
        ContainerDb(convdb, "Conversation Database", "PostgreSQL", "Chat history<br/>and conversation logs")
        ContainerDb(redis, "Redis Cache", "Redis", "Session storage<br/>and performance caching")
    }
    
    System_Ext(gemini, "Google Gemini API", "External AI service<br/>for response generation")
    
    %% User to Frontend
    Rel(user, frontend, "Uses web interface", "HTTPS")
    
    %% Frontend to Services
    Rel(frontend, auth, "Authentication", "REST API")
    Rel(frontend, emotion, "Emotion analysis", "REST API")
    Rel(frontend, ai, "AI responses", "REST API")
    Rel(frontend, websocket, "Real-time updates", "WebSocket")
    
    %% Service to Database connections
    Rel(auth, authdb, "User data", "SQL")
    Rel(conversation, convdb, "Chat history", "SQL")
    
    %% Service to Cache connections
    Rel(auth, redis, "Session cache", "TCP")
    Rel(emotion, redis, "Result cache", "TCP")
    Rel(ai, redis, "Response cache", "TCP")
    Rel(websocket, redis, "Session data", "TCP")
    
    %% Inter-service communication
    Rel(emotion, auth, "Token validation", "REST API")
    Rel(ai, auth, "Token validation", "REST API")
    Rel(conversation, auth, "Token validation", "REST API")
    Rel(websocket, auth, "Token validation", "REST API")
    
    Rel(conversation, emotion, "Emotion analysis", "REST API")
    Rel(websocket, emotion, "Emotion analysis", "REST API")
    Rel(websocket, ai, "AI responses", "REST API")
    
    %% External API
    Rel(ai, gemini, "AI generation", "HTTPS")
    
    UpdateLayoutConfig($c4ShapeInRow="3", $c4BoundaryInRow="2")
            </div>
        </div>
        
        <div class="features">
            <div class="feature-card">
                <h3>üèóÔ∏è Architecture Patterns</h3>
                <ul>
                    <li>Microservices Architecture</li>
                    <li>Database-per-Service</li>
                    <li>API Gateway Pattern</li>
                    <li>Service Discovery</li>
                    <li>Event-Driven Communication</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>üöÄ Core Services</h3>
                <ul>
                    <li>Authentication & Authorization</li>
                    <li>Emotion Analysis Engine</li>
                    <li>Conversation Management</li>
                    <li>AI Response Generation</li>
                    <li>Real-time WebSocket Communication</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>üíæ Data Management</h3>
                <ul>
                    <li>PostgreSQL Databases</li>
                    <li>Redis Caching Layer</li>
                    <li>Data Isolation per Service</li>
                    <li>Session Management</li>
                    <li>Performance Optimization</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>üîß DevOps & Deployment</h3>
                <ul>
                    <li>Docker Containerization</li>
                    <li>Docker Compose Orchestration</li>
                    <li>Kubernetes Ready</li>
                    <li>Health Monitoring</li>
                    <li>Scalable Architecture</li>
                </ul>
            </div>
        </div>
        
        <div class="tech-stack">
            <h3>üõ†Ô∏è Technology Stack</h3>
            <div class="tech-badges">
                <span class="tech-badge">Python</span>
                <span class="tech-badge">Flask</span>
                <span class="tech-badge">PostgreSQL</span>
                <span class="tech-badge">Redis</span>
                <span class="tech-badge">Docker</span>
                <span class="tech-badge">WebSocket</span>
                <span class="tech-badge">JWT</span>
                <span class="tech-badge">REST API</span>
                <span class="tech-badge">Nginx</span>
                <span class="tech-badge">TextBlob</span>
                <span class="tech-badge">Gemini API</span>
                <span class="tech-badge">Kubernetes</span>
            </div>
        </div>
    </div>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            c4: {
                diagramMarginX: 50,
                diagramMarginY: 50,
                c4ShapeMargin: 50,
                c4ShapePadding: 20,
                width: 216,
                height: 60,
                boxMargin: 10,
                useMaxWidth: true,
                wrap: true
            }
        });

        // Download diagram as PNG
        function downloadDiagram() {
            const svg = document.querySelector('.mermaid svg');
            if (!svg) {
                alert('Diagram not loaded yet. Please wait a moment and try again.');
                return;
            }
            
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const data = new XMLSerializer().serializeToString(svg);
            const img = new Image();
            
            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0);
                
                const link = document.createElement('a');
                link.download = 'emotibot-architecture-diagram.png';
                link.href = canvas.toDataURL();
                link.click();
            };
            
            img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(data)));
        }

        // Toggle fullscreen
        function toggleFullscreen() {
            const container = document.getElementById('diagram-container');
            if (!document.fullscreenElement) {
                container.requestFullscreen().catch(err => {
                    alert('Error attempting to enable fullscreen: ' + err.message);
                });
            } else {
                document.exitFullscreen();
            }
        }

        // Print diagram
        function printDiagram() {
            window.print();
        }

        // Auto-refresh diagram if needed
        setTimeout(() => {
            if (!document.querySelector('.mermaid svg')) {
                location.reload();
            }
        }, 5000);
    </script>
</body>
</html> 